% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/defineModel.R
\name{defineModel}
\alias{defineModel}
\title{defineModel.R}
\usage{
defineModel(
  args = list(n_datasets = 2, covariates_i = NULL, covariates_t = NULL, covariates_it =
    NULL, covariates_det = NULL, inclPhenology = FALSE, has_date = NULL)
)
}
\arguments{
\item{args}{A named list of arguments used to customise model structure. Must include:
\describe{
\item{\code{n_datasets}}{Integer. Number of separate detection sub-models (e.g., from different datasets).}
\item{\code{covariates_i}}{Character vector. Names of 1D site-level covariates.}
\item{\code{covariates_t}}{Character vector. Names of 1D year-level covariates.}
\item{\code{covariates_it}}{Character vector. Names of 2D site-year covariates.}
\item{\code{covariates_det}}{List of character vectors. One per dataset, naming detection covariates.}
\item{\code{inclPhenology}}{Logical. Whether to include phenology terms (default = FALSE).}
\item{\code{has_date}}{Logical vector of length \code{n_datasets}. Whether each detection dataset includes Julian dates.}
}}
}
\value{
A \code{nimbleCode} object defining the hierarchical state-space model, including:
\itemize{
\item Priors for parameters governing occupancy and detection.
\item A latent occupancy model indexed over sites and years.
\item Detection models for each observational dataset (Bernoulli trials).
\item Optionally, a phenology submodel (normalised gamma curve over Julian day).
\item Derived quantities such as annual occupancy mean (\code{psi.fs[t]}).
}
}
\description{
Define a NIMBLE model for integrated species distribution model
}
\details{
Constructs a flexible hierarchical Bayesian model using NIMBLE. The model includes latent
occupancy states, optional covariates (site, time, and site-year), detection sub-models with their
own covariates, and an optional phenology curve effects. The function builds and returns a \code{nimbleCode} object.

This function dynamically generates model code as a character string using \code{glue()}, then evaluates
it into a NIMBLE-compatible model using \code{nimbleCode()}. Covariate names are automatically converted
to parameter names (e.g., \code{b_covname}) and included in the model formulae. Detection models are built
per dataset, each with its own detection covariates and phenology settings.
}
\examples{
\dontrun{
model_code <- defineModel(list(
  n_datasets = 2,
  covariates_i = c("elevationcs", "woodlandcs"),
  covariates_t = c("year_tas_anomaly"),
  covariates_it = c("annual_MAT"),
  covariates_det = list(c("mins_on_site", "list_length"), c("list_length")),
  inclPhenology = TRUE,
  has_date = c(TRUE, FALSE)
))
}

}
